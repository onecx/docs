<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Project structure :: OneCX Docs</title>
    <link rel="canonical" href="https://onecx.github.io/docs/guides/current/quarkus/project-structure.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js/dist/assets/diagram-js.css">
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js/dist/assets/bpmn-font/css/bpmn.css">
    <link rel="stylesheet" href="../../../_/css/bpmn.css">
    <link href="../../../_/css/fontawesome.css" rel="stylesheet" />
    <link href="../../../_/css/brands.css" rel="stylesheet" />
    <link href="../../../_/css/solid.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui.css">
    <script>var uiRootPath = '../../../_'</script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/bpmn-js/dist/bpmn-viewer.production.min.js"></script>
    <script src="https://unpkg.com/dmn-js@11.0.2/dist/dmn-viewer.production.min.js"></script>
    <script src="../../../_/js/bpmn.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui-standalone-preset.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui-bundle.js"></script>

  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://onecx.github.io/docs">OneCX Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="/docs">Home</a>
        <!--  <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="/docs/docs-guides-quarkus/latest/">Quarkus</a>
            <a class="navbar-item" href="/docs/docs-guides-bpmn/latest/">Bpmn</a>
          </div> 
        </div> -->
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="guides" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../general/index.html">Guides</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../general/index.html">General</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Documentation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../documentation/setup/product.html">Create new product</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../documentation/setup/repository.html">Integrating new repository</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Angular</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../angular/general/index.html">General</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../angular/general/guidelines.html">Guidelines</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Cookbook</span>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../angular/ngrx/ngrx.html">NgRx</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Libraries</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../angular/libraries/symlink.html">How to create a SymLink</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../angular/libraries/workingWithSharedLibraries.html">Working with shared libraries</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Quarkus</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="project-structure.html">Project structure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quarkus-github-actions.html">Project GitHub Actions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quarkus-rest-api.html">Rest API CRUD Guidelines</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quarkus-svc.html">Backend service (svc)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quarkus-bff.html">Backend from frontends (bff)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quarkus-operator.html">K8s operator (operator)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">BPMN</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../bpmn/cancel-timer.html">Cancel timer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../bpmn/request-callback.html">Request callback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../bpmn/messages.html">Messages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../bpmn/open-topics.html">Open topics</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Guides</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../onecx-announcement/current/onecx-announcement/index.html">Announcement Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-announcement/current/onecx-announcement/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-document-management/current/onecx-document-management/index.html">Document Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-document-management/current/onecx-document-management/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../document-management/current/index.html">Document Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../document-management/current/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../general/index.html">Guides</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-help/current/general/index.html">Help Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-help/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-iam/current/onecx-iam/index.html">IAM Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-iam/current/onecx-iam/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../index/current/index.html">OneCX Docs</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../index/current/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../nx-plugins/current/general/index.html">OneCX generator</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../nx-plugins/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-quarkus/current/onecx-quarkus/index.html">Onecx Quarkus</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-quarkus/current/onecx-quarkus/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-parameter/current/onecx-parameter/index.html">Parameter Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-parameter/current/onecx-parameter/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-permission/current/onecx-permission/index.html">Permission Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-permission/current/onecx-permission/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-product-store/current/onecx-product-store/index.html">Product Store Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-product-store/current/onecx-product-store/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-tenant/current/onecx-tenant/index.html">Tenant Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-tenant/current/onecx-tenant/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-theme/current/onecx-theme/index.html">Theme Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-theme/current/onecx-theme/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-user-profile/current/onecx-user-profile/index.html">User Profile Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-user-profile/current/onecx-user-profile/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-welcome/current/onecx-welcome/index.html">Welcome Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-welcome/current/onecx-welcome/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-workspace/current/onecx-workspace/index.html">Workspace Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-workspace/current/onecx-workspace/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../index/current/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../general/index.html">Guides</a></li>
    <li>Quarkus</li>
    <li><a href="project-structure.html">Project structure</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/onecx/docs-guides-quarkus/edit/main/docs/modules/quarkus/pages/project-structure.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
      <h1 class="page">Project structure</h1>
    <div class="sect1">
<h2 id="_onecx_quarkus_project_structure"><a class="anchor" href="#_onecx_quarkus_project_structure"></a>OneCx Quarkus project structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OneCx Quarkus project is [Maven](<a href="https://maven.apache.org/" class="bare">https://maven.apache.org/</a>) project.We use default maven structure which includes: java code and resources, helm templates and dockerfile.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">.github
src
  main
     docker
        Dockerfile.jvm
        Dockerfile.native
     helm
        Chart.yaml
        values.yaml
     openapi
        example-openapi.yaml
     java
     resources
       application.properties
  test
     java
     resources
pom.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The helm template are in the <code>src/main/helm</code> and dockerfile is in the <code>src/main/docker/Dockerfile</code> directory.</p>
</div>
<div class="paragraph">
<p>GitHub project configuration is defined in the <code>.github</code> directory. For more information please check next chapter <a href="quarkus-github-actions.html" class="xref page">Project GitHub Actions</a></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Onecx Quarkus project GitHub Actions <a href="quarkus-github-actions.html" class="xref page">Project GitHub Actions</a> setup.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_java_naming_convention"><a class="anchor" href="#_java_naming_convention"></a>Java naming convention</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Basically all our microservice consist of 3 main layers</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Endpoint components providing REST api to outside world.</p>
</li>
<li>
<p>IntermediateService which implements business logic. These components are often omitted.</p>
</li>
<li>
<p>Entity services are components taking care of data management, basically fetching storing the data from/to database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Java classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RestController – Any class named RestController is supposed to expose API to outside world  For example: <code>UserRestController</code></p>
</li>
<li>
<p>Service – (IntermediateService) the core components containing business logic, shareable piece of codes for other components usually controllers or other services as well. For example: <code>UserValidationService</code></p>
</li>
<li>
<p>Mapper - Object mapper. For example: <code>UserMapper</code>.</p>
</li>
<li>
<p>DAO - Data access object (JPA entity wrapper) For example: <code>UserDAO</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each project should have own package which contains the domain of the project.
All projects start with a package <code>org.tkit.onecx</code> and package <code>&lt;groupId&gt;.&lt;artefactId | simplified&gt;</code></p>
</div>
<div class="paragraph">
<p>For example our Maven project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>groupId = <code>org.tkit.onecx.example</code></p>
</li>
<li>
<p>artefactId = <code>onecx-quarkus-example</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">org.tkit.onecx.quarkus.example</code></pre>
</div>
</div>
<div class="paragraph">
<p>Model and REST packages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">domain.models  // JPA entities
domain.daos // DAO and search criteria for the entities
domain.services // Common shared domain services
rs // common rs classes (CORSFilter, JaxRSActivator..)
rs.internal.controllers // REST controllers
rs.internal.mappers // internal DTOs mappers
rs.&lt;version&gt;.controllers // REST controllers
rs.&lt;version&gt;.logs // log mappers
rs.&lt;version&gt;.mappers // external DTOs mappers
rs.subdomain.&lt;version&gt;.controllers // subdomain REST controllers
rs.subdomain.&lt;version&gt;.logs // log mappers
rs.subdomain.&lt;version&gt;.mappers // subdomain DTOs mappers</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example application</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">org.tkit.onecx.quarkus.example.domain.models  // JPA entities
org.tkit.onecx.quarkus.example.domain.daos // DAO for the entities
org.tkit.onecx.quarkus.example.domain.services // DAO for the entities
org.tkit.onecx.quarkus.example.rs //common rs classes (CORSFilter, JaxRSActivator..)
org.tkit.onecx.quarkus.example.rs.internal.controllers // REST controllers
org.tkit.onecx.quarkus.example.rs.internal.mappers // internal DTOs mappers
org.tkit.onecx.quarkus.example.rs.&lt;version&gt;.controllers // REST controllers
org.tkit.onecx.quarkus.example.rs.&lt;version&gt;.mappers // external DTOs mappers</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">For the rest-controllers we need to have two types of the rest endpoints:</div>
<div class="ulist">
<ul>
<li>
<p>internal - which are us only for the internal domain, for example for UI</p>
</li>
<li>
<p>&lt;version | external&gt; - these REST controllers are external interfaces to rest of the world. For these we need to have version.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_docker"><a class="anchor" href="#_docker"></a>Docker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the project we have defined two docker files, one for java base docker image and one for native build docker image. The source code for the base docker image can be found in the GitHub repositories <a href="https://github.com/onecx/docker-quarkus-jvm">docker-quarkus-native</a> and <a href="https://github.com/onecx/docker-quarkus-jvm">docker-quarkus-jvm</a>.</p>
</div>
<div class="paragraph">
<p>The two <code>Dockerfiles</code> look like this:</p>
</div>
<details open>
<summary class="title">Dockerfile.jvm definition</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM ghcr.io/onecx/docker-quarkus-jvm:0.5.0

COPY --chown=185 target/quarkus-app/lib/ /deployments/lib/
COPY --chown=185 target/quarkus-app/*.jar /deployments/
COPY --chown=185 target/quarkus-app/app/ /deployments/app/
COPY --chown=185 target/quarkus-app/quarkus/ /deployments/quarkus/
USER 185</code></pre>
</div>
</div>
</div>
</details>
<details open>
<summary class="title">Dockerfile.native definition</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM ghcr.io/onecx/docker-quarkus-native:0.3.0

COPY --chown=1001:root target/*-runner /work/application</code></pre>
</div>
</div>
</div>
</details>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Docker build configuration is defined in the <a href="https://github.com/onecx/onecx-quarkus3-parent">onecx-quarkus3-parent</a>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For more information about Quarkus docker extension, please check the official documentation <a href="https://quarkus.io/guides/container-image">quarkus-container-image-docker</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_helm"><a class="anchor" href="#_helm"></a>Helm</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the <code>src/main/helm</code> we musst define <code>Chart.yaml</code> in version <code>v2</code> and <code>values.yaml</code>. The helm chart of the services musst use the helm-quarkus-app helm dependencies. The alias for every onecx quarkus application is <code>app</code>. The GitHub pipeline will replace the chart <code>version</code> and <code>appVersion</code> during the build with current service version.</p>
</div>
<details open>
<summary class="title">Chart.yaml</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v2
name: onecx-example-svc
version: 0.0.0
appVersion: 0.0.0
description: Onecx example service
keywords:
  - example
sources:
  - https://github.com/onecx/onecx-example-svc
maintainers:
  - name: Tkit Developer
    email: tkit_dev@1000kit.org
dependencies:
  - name: helm-quarkus-app
    alias: app
    version: ^0
    repository: oci://ghcr.io/onecx/charts</code></pre>
</div>
</div>
</div>
</details>
<details open>
<summary class="title">values.yaml</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">app:
  name: svc
  image:
    repository: "onecx/onecx-example-svc"
  db:
    enabled: true</code></pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>In our example we did activate the <code>database</code> configuration <code>app.db.enabled: true</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
For product base delivery <code>helm-of-helm</code> we do need to specify the <code>app.name</code>, which is the name of the component in the product (for example svc, bff, operator).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more details of the helm template configuration check the repository of <a href="https://github.com/onecx/helm-quarkus-app">helm-quarkus-app</a>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Helm documentation <a href="https://helm.sh/docs/">helm</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
  </article>  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script>
    document.addEventListener('readystatechange', event => {
    if (event.target.readyState === "complete") {
        renderAllBpmnJs();
    }
    });    
</script>
  </body>
</html>
