:idprefix:
:idseparator: -
:imagesdir: ../../images

:onecx_local_env_docs_ref: xref:documentation:onecx-local-env:index.adoc
:onecx_docs_guideline_ref: xref:../guidelines/docs_guidelines.adoc[OneCX Documentation Guidelines]
:onecx_docs_repo_link:     link:https://github.com/onecx/docs[OneCX Docs]
:kiss_principle_link:      link:https://en.wikipedia.org/wiki/KISS_principle[KISS]
:antora_doc_link:          link:https://docs.antora.org/antora/latest/[Antora]
:asciidoc_doc_link:        link:https://docs.asciidoctor.org/asciidoc/latest/[AsciiDoc]


= OneCX Documentation Guide

This guide describes how to create documentation for OneCX projects using {antora_doc_link} and {asciidoc_doc_link}.

Follow the guidelines in {onecx_docs_guideline_ref}.


== Set up Locally
To preview and test your documentation changes locally, set up the documentation environment as following:

* Clone the {onecx_docs_repo_link}.
* ...
* Use asciidoc plugin in your IDE for syntax highlighting and preview.
* Check the log output after building the website to identify issues.


== Main Structure
The OneCX documentation is organized by a *parent site* (see {onecx_docs_repo_link}) that *aggregates* multiple *modules* (e.g. onecx-local-env, onecx-docs-apps).

* The parent site defines all basics for the Antora project. Do not add concurrent settings in the local `antora.yml` of modules. The name of the component in the parent site and ALL modules is *documentation*.
* Each OneCX project (application, UI libraries etc.) must have its own corresponding module. The module name must follow the project name and be unique.

When creating documentation for a new OneCX project, follow this guideline for structuring your module:


[horizontal]
Component name::  Use the shared component *documentation* (in module `antora.yml`). +
                  = This integrates your docs into the parent OneCX docs site.
Version::         Use *latest* (in `antora.yml`) to always point to the most recent docs. +
                  = Versioning is handled at the parent site level.
Module::          Create a dedicated module per project, e.g. `modules/<your-project>/` with subfolders: +
	pages:::     Contains pages (`*.adoc`)
	images:::    Project-specific images referenced from pages.
	partials:::  Reusable fragments like `attributes.adoc` and `nav.adoc`.


[cols="1a,^1a"]
|===
| Recommended Layout | Example: onecx-local-env

| 
include::./_docs_structure.adoc[]
| image::asciidoc_project_structure.png[width="200",alt="Documentation Structure",title="Documentation Structure"]

|===


== Formatting & Conventions
This guide summarizes a collection of common {asciidoc_doc_link} features and conventions to be used in OneCX documentation.

[TIP]
====
Familiarize yourself with {asciidoc_doc_link} and {antora_doc_link}.
====

=== Navigation
* Each module must have a `nav.adoc` file in the `partials/` folder.
* The `nav.adoc` defines the module navigation structure.
* Follow the structure of existing modules as reference.

[CAUTION]
====
. A module is part of the overall documentation site.

. Make your module navigation fit into the overall site structure. +
  Limit the number of levels and avoid deep nesting. +
  Check this after adding new pages. 
====


=== Global Attributes
* Global attributes are set on the parent site. Do not redefine them in modules.
+
.Global Attributes, excerpt
[source,asciidoc]
----
    product: OneCX Platform
    product-version: latest
    toclevels: 2
----

=== Page Attributes
* Page attributes can be defined on top of the page as needed.
* A good practice is to 
** set `:imagesdir:` to the local `images/` folder of the module.
** define attributes for commonly referenced URLs.

.Example page header
[source,asciidoc,subs="verbatim"]
----
:idprefix:
:idseparator: -
:imagesdir: ../images

:asciiidoc_doc_link:    link:https://docs.asciidoctor.org/asciidoc/latest/[AsciiDoc]
:api_guidelines_link:   xref:documentation:onecx-docs-dev:guidelines/api_guidelines.adoc[API Guidelines]
----

=== Headings
- Use consistent heading levels (`==`, `===`, `====`) throughout the documentation.
- Limit nesting to 3â€“4 levels for clarity.
- Use meaningful and concise headings that reflect the content of the section.
- Avoid overly long or complex headings => Check TOC for readability.

.Heading Examples - TOC view
[cols="^1a,^1a"]
|===
| 
.Bad Heading Example
image::docs_guide/docs_guide_heading_bad_example.png[]
| 
.Good Heading Example
image::docs_guide/docs_guide_heading_good_example.png[]

|===


=== Includes
- Use `include::` to reuse content.
- When embedding a page section under the current heading, apply `leveloffset`.

.Example Include with leveloffset
[source,asciidoc]
----
 include::./scripts.adoc[leveloffset=+1]
----

- Place frequently reused fragments in `partials/` folder of the module.


=== Collapsible Sections
- Wrap long text, tables or optional sections with `[%collapsible] in ====` blocks:

.Example Collapsible Section (source)
[source,asciidoc]
----
 [%collapsible]
 ====
 include::documentation:onecx-docs-apps:partial$core-app-table.adoc[]
 ====
----

.Example Collapsible Section (rendered)
[%collapsible]
====
include::documentation:onecx-docs-apps:partial$core-app-table.adoc[]
====


=== Cross-References
- Use `xref:` for links within OneCX documentation.
- Do not use hard coded URLs on the final docs site.
- Keep links relative within the module if possible.

.Example module-internal links
[source,asciidoc]
----
xref:./setup.adoc[Setting up]
xref:./scripts/start.adoc[start-onecx.sh]
----

- For cross-module references, use the full path:

.Example module-2-module link
[source,asciidoc]
----
xref:documentation:onecx-docs-dev:guidelines/api_guidelines.adoc[API Guidelines]
----


=== External Links
- Use concise inline links:

[source,asciidoc]
----
https://www.keycloak.org/[Keycloak]
----

- Define attributes for commonly referenced URLs and reuse them.


=== Anchors
- Use anchors for deep-links to specific sections

[source,asciidoc]
----
[#available-flags]
== Available Flags
----


=== Admonitions
- Use AsciiDoc admonitions for clarity.
- Standard types: `NOTE`, `IMPORTANT`, `CAUTION`, `TIP`, `WARNING`

.Example Admonition
[source,asciidoc]
----
[IMPORTANT]
====
Critical guidance, e.g., WSL2 setup on Windows.
====
----

[IMPORTANT]
====
Critical guidance, e.g., WSL2 setup on Windows.
====


=== Code Blocks
- Use `[source,<lang>]` with fenced blocks.
- Language examples: `bash`, `powershell`, `text`, `javascript`, `json`, `yaml`, `xml`, `sql`.

.Example Source Block (source)
[source,asciidoc]
----
 [source,bash]
 ----
 ./start-onecx.sh -p all
 ----
----

.Example Source Block (rendered)
[source,bash]
----
./start-onecx.sh -p all
----


=== Images
- Set `:imagesdir:` and reference images with meaningful captions (mandatory!):

[source,asciidoc]
----
.Successful start
image::scripts/script_start-onecx.sh.png[]
----


=== Lists
- Common list types: unordered (`*`), ordered (`.`), and description lists.
- Use nested lists for sub-items.
- Description lists are great for compact option docs.
- Add the `horizontal` role for side-by-side rendering and specify labelwidth in percent if needed.

.Example Description List (source)
[source,asciidoc]
----
-s::
Enables secure mode, which enforces authentication/authorization and taken into account the tenant ID of the user. (Default: disabled)
----

-s::
Enables secure mode, which enforces authentication/authorization and taken into account the tenant ID of the user. (Default: disabled)

.Example Description List, horizontal (source)
[source,asciidoc]
----
[horizontal,labelwidth=10]
-s::
Enables secure mode, which enforces authentication/authorization and taken into account the tenant ID of the user. (Default: disabled)
----

[horizontal,labelwidth=10]
-s::
Enables secure mode, which enforces authentication/authorization and taken into account the tenant ID of the user. (Default: disabled)


=== Tables
- Use role-based striped tables and column definitions.
- The first line is the header, followed by a blank line, unless otherwise defined.
- Do not use huge tables.

.Example Table (source)
[source,asciidoc]
----
[.stripes-even,cols="20,~"]
|===
| Service  | Description

| Keycloak | IAM service used by OneCX
| pgAdmin  | Manage Postgres databases
|===
----

.Example Table (rendered)
[.stripes-even,cols="20,~"]
|===
| Service  | Description

| Keycloak | IAM service used by OneCX
| pgAdmin  | Manage Postgres databases
|===


include::./_docs_writing_style.adoc[]

== Reference
See the {onecx_local_env_docs_ref}[OneCX Local Environment] - it is our reference implementation for structure, style and conventions.

