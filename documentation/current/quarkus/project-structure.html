<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Project structure :: OneCX Docs</title>
    <link rel="canonical" href="https://onecx.github.io/docs/documentation/current/quarkus/project-structure.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js/dist/assets/diagram-js.css">
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js/dist/assets/bpmn-font/css/bpmn.css">
    <link rel="stylesheet" href="../../../_/css/bpmn.css">
    <link href="../../../_/css/fontawesome.css" rel="stylesheet" />
    <link href="../../../_/css/brands.css" rel="stylesheet" />
    <link href="../../../_/css/solid.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui.css">
    <script>var uiRootPath = '../../../_'</script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/bpmn-js/dist/bpmn-viewer.production.min.js"></script>
    <script src="https://unpkg.com/dmn-js@11.0.2/dist/dmn-viewer.production.min.js"></script>
    <script src="../../../_/js/bpmn.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui-standalone-preset.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui-bundle.js"></script>

  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://onecx.github.io/docs">OneCX Docs</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="/docs">Home</a>
        <!--  <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="/docs/docs-guides-quarkus/latest/">Quarkus</a>
            <a class="navbar-item" href="/docs/docs-guides-bpmn/latest/">Bpmn</a>
          </div> 
        </div> -->
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="documentation" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">documentation</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../onecx-announcement/current/general/index.html">Announcement Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-announcement/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-bookmark/current/general/index.html">Bookmark Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-bookmark/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../contribution/current/contribution/index.html">Contribution</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../contribution/current/contribution/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-document-management/current/general/index.html">Document Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-document-management/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../general-information/current/general/index.html">General Information</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../general-information/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../guides/current/index.html">Guides</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../guides/current/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-help/current/general/index.html">Help Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-help/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-iam/current/general/index.html">IAM Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-iam/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../index/current/index.html">Index</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../index/current/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-portal-ui-libs/current/general/index.html">OneCX Portal UI Libs</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-portal-ui-libs/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-quarkus/current/onecx-quarkus/index.html">Onecx Quarkus</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-quarkus/current/onecx-quarkus/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-parameter/current/general/index.html">Parameter Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-parameter/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-permission/current/general/index.html">Permission Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-permission/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-product-store/current/general/index.html">Product Store Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-product-store/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-shell/current/general/index.html">Shell UI</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-shell/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-tenant/current/general/index.html">Tenant Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-tenant/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-test/current/general/index.html">Test Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-test/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-theme/current/general/index.html">Theme Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-theme/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-user-profile/current/general/index.html">User Profile Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-user-profile/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../utilities/current/general-info/index.html">Utilities</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../utilities/current/general-info/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-welcome/current/general/index.html">Welcome Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-welcome/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../onecx-workspace/current/general/index.html">Workspace Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../onecx-workspace/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../index/current/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/onecx/docs-guides-quarkus/edit/main/docs/modules/quarkus/pages/project-structure.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
      <h1 class="page">Project structure</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The source code of the sample application is located in the documentation repository <a href="https://github.com/onecx/docs-guides-quarkus/tree/main/docs/modules/quarkus/examples/quarkus/base/example">Base example</a>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_onecx_quarkus_project_structure"><a class="anchor" href="#_onecx_quarkus_project_structure"></a>OneCx Quarkus project structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OneCx Quarkus project is <a href="https://maven.apache.org/">Maven</a> project.We use default maven structure which includes: java code and resources, helm templates and dockerfile.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">.github                         // github configuration
src                             // source code directory
  main                          // main resources
     docker                     // docker configuration
        Dockerfile.jvm          // JVM docker image
        Dockerfile.native       // Native docker image
     helm                       // helm template
        Chart.yaml              // helm chart for application
        values.yaml             // helm chart values for the application
     openapi                    // openapi definitions
        example-openapi.yaml    // example api definition
     java                       // java source code
     resources                  // application resources
       application.properties   // quarkus configuration
  test                          // test resources
     java                       // java tests
     resources                  // test resources
pom.xml                         // maven project configuration</code></pre>
</div>
</div>
<div class="paragraph">
<p>The helm template are in the <code>src/main/helm</code> and dockerfile is in the <code>src/main/docker</code> directory.</p>
</div>
<div class="paragraph">
<p>GitHub project configuration is defined in the <code>.github</code> directory. For more information please check next chapter <a href="quarkus-github-actions.html" class="xref page">Project GitHub Actions</a></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Onecx Quarkus project GitHub Actions <a href="quarkus-github-actions.html" class="xref page">Project GitHub Actions</a> setup.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_maven_configuration"><a class="anchor" href="#_maven_configuration"></a>Maven configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Onecx project are using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;parent&gt;
    &lt;groupId&gt;org.tkit.onecx&lt;/groupId&gt;
    &lt;artifactId&gt;onecx-quarkus3-parent&lt;/artifactId&gt;
    &lt;version&gt;0.67.0&lt;/version&gt;
&lt;/parent&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_java_naming_convention"><a class="anchor" href="#_java_naming_convention"></a>Java naming convention</h2>
<div class="sectionbody">
<div class="imageblock kroki">
<div class="content">
<img src="_images/diag-1ec88c3f3f581782c2edae77bff812148dc2028e.svg" alt="Diagram">
</div>
</div>
<div class="paragraph">
<p>Basically all our microservice consist of 3 main layers</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Boundary components providing REST api ( or AMQP, Events, &#8230;&#8203;) to outside world.</p>
</li>
<li>
<p>IntermediateService which implements business logic. These components are often omitted.</p>
</li>
<li>
<p>Entity services are components taking care of data management, basically fetching storing the data from/to database</p>
</li>
<li>
<p>Client services which are</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Java classes:</p>
</div>
<div class="paragraph">
<p>Validation request sequence:</p>
</div>
<div class="imageblock kroki">
<div class="content">
<img src="_images/diag-c94b3f7d34ab9ca18a9f4ef0f4cf369942390d0c.svg" alt="Diagram">
</div>
</div>
<div class="paragraph">
<p>Create user request sequence:</p>
</div>
<div class="imageblock kroki">
<div class="content">
<img src="_images/diag-3c4d8eacdfd4da4ba759013fb5949931a6ff7752.svg" alt="Diagram">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>RestController – Any class named RestController is supposed to expose API to outside world  For example: <code>UserRestController</code></p>
</li>
<li>
<p>Service – (IntermediateService) the core components containing business logic, shareable piece of codes for other components usually controllers or other services as well. For example:  <code>UserValidationService</code></p>
</li>
<li>
<p>Mapper - Object mapper for mapping DTO to internal models and vice versa. For example: <code>UserMapper</code>.</p>
</li>
<li>
<p>DAO - Data access object (JPA entity wrapper) For example: <code>UserDAO</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each project should have own package which contains the domain of the project.
All projects in the <code>onecx</code> context start with a package <code>org.tkit.onecx</code> and package <code>&lt;artefactId | simplified&gt;</code></p>
</div>
<div class="paragraph">
<p>For example our Maven project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>groupId = <code>org.tkit.onecx</code></p>
</li>
<li>
<p>artefactId = <code>onecx-quarkus-example</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">src
    main
        java
            org.tkit.onecx.quarkus.example</code></pre>
</div>
</div>
<div class="paragraph">
<p>Microservice package structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">domain.models                       // JPA entities
domain.criteria                     // JPA criteria
domain.daos                         // DAO and search criteria for the entities
domain.services                     // Common intermediate shared domain services
rs                                  // common rs classes (CORSFilter, JaxRSActivator..)
rs.internal.controllers             // REST controllers
rs.internal.mappers                 // internal DTOs mappers
rs.internal.services                // internal intermediate services
rs.external.&lt;version&gt;.controllers            // REST controllers
rs.external.&lt;version&gt;.logs                   // log mappers
rs.external.&lt;version&gt;.mappers                // external DTOs mappers
rs.external.&lt;version&gt;.services               // Intermediate services for the rest &lt;version&gt; interface</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our <a href="#example$quarkus/base/example/src/main/java/org/tkit/onecx">org.tkit.onecx</a> package of our example application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">org.tkit.onecx
    quarkus
        example
            domain
                models              // JPA entities
                daos                // DAO for the entities
                services            // DAO for the entities
            rs                      //common rs classes (CORSFilter, JaxRSActivator..)
                controllers         // REST controllers
                internal
                mappers             // internal DTOs mappers
                external
                    &lt;version&gt;
                        controllers // REST controllers
                        mappers     // external DTOs mappers</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">For the rest-controllers we need to have two types of the rest endpoints:</div>
<div class="ulist">
<ul>
<li>
<p>internal - which are us only for the internal domain, for example for UI</p>
</li>
<li>
<p>&lt;version | external&gt; - these REST controllers are external interfaces to rest of the world. For these we need to have version.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_docker"><a class="anchor" href="#_docker"></a>Docker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the project we have defined two docker files, one for java base docker image and one for native build docker image. The source code for the base docker image can be found in the GitHub repositories <a href="https://github.com/onecx/docker-quarkus-jvm">docker-quarkus-native</a> and <a href="https://github.com/onecx/docker-quarkus-jvm">docker-quarkus-jvm</a>.</p>
</div>
<div class="paragraph">
<p>The two <code>Dockerfiles</code> look like this:</p>
</div>
<div class="listingblock">
<div class="title">Dockerfile.jvm definition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM ghcr.io/onecx/docker-quarkus-jvm:0.15.0

COPY --chown=185 target/quarkus-app/lib/ /deployments/lib/
COPY --chown=185 target/quarkus-app/*.jar /deployments/
COPY --chown=185 target/quarkus-app/app/ /deployments/app/
COPY --chown=185 target/quarkus-app/quarkus/ /deployments/quarkus/
USER 185</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Dockerfile.native definition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM ghcr.io/onecx/docker-quarkus-native:0.10.0

COPY --chown=1001:root target/*-runner /work/application</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Docker build configuration is defined in the maven parent project.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For more information about Quarkus docker extension, please check the official documentation <a href="https://quarkus.io/guides/container-image">quarkus-container-image-docker</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_helm"><a class="anchor" href="#_helm"></a>Helm</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the <code>src/main/helm</code> we muss define <code>Chart.yaml</code> in version <code>v2</code> and <code>values.yaml</code>. The alias for every onecx quarkus application is <code>app</code>. The GitHub pipeline will replace the chart <code>version</code> and <code>appVersion</code> during the build with current service version.</p>
</div>
<div class="listingblock">
<div class="title">Chart.yaml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v2
name: onecx-quarkus-example
version: 0.0.0
appVersion: 0.0.0
description: Onecx quarkus example
keywords:
  - example
sources:
  - https://github.com/onecx/onecx-quarkus-example
maintainers:
  - name: Tkit Developer
    email: tkit_dev@1000kit.org
dependencies:
  - name: helm-quarkus-app
    alias: app
    version: ^0
    repository: oci://ghcr.io/onecx/charts</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">values.yaml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">app:
 name: svc
 db:
   enabled: true
 image:
  repository: "onecx/onecx-quarkus-example"</code></pre>
</div>
</div>
<div class="paragraph">
<p>In our example we did activate the <code>database</code> configuration <code>app.db.enabled: true</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
For product base delivery <code>helm-of-helm</code> we do need to specify the <code>app.name</code>, which is the name of the component in the product (for example svc, bff, operator).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more details of the helm template configuration check the repository of <a href="https://github.com/onecx/helm-quarkus-app">helm-quarkus-app</a>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Helm documentation <a href="https://helm.sh/docs/">helm</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
  </article>  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
<script>
    document.addEventListener('readystatechange', event => {
    if (event.target.readyState === "complete") {
        renderAllBpmnJs();
    }
    });    
</script>
  </body>
</html>
