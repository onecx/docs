<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Versions - v2 - Migrate to v2 :: OneCX Docs</title>
    <link rel="canonical" href="https://onecx.github.io/docs/documentation/current/local-env/general/versions/v2/migrate.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../../../../_/css/site.css">
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js/dist/assets/diagram-js.css">
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js/dist/assets/bpmn-font/css/bpmn.css">
    <link rel="stylesheet" href="../../../../../../_/css/bpmn.css">
    <link href="../../../../../../_/css/fontawesome.css" rel="stylesheet" />
    <link href="../../../../../../_/css/brands.css" rel="stylesheet" />
    <link href="../../../../../../_/css/solid.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui.css">
    <script>var uiRootPath = '../../../../../../_'</script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/bpmn-js/dist/bpmn-viewer.production.min.js"></script>
    <script src="https://unpkg.com/dmn-js@11.0.2/dist/dmn-viewer.production.min.js"></script>
    <script src="../../../../../../_/js/bpmn.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui-standalone-preset.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@3.52.5/swagger-ui-bundle.js"></script>

  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://onecx.github.io/docs">OneCX Docs</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="/docs">Home</a>
        <!--  <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="/docs/docs-guides-quarkus/latest/">Quarkus</a>
            <a class="navbar-item" href="/docs/docs-guides-bpmn/latest/">Bpmn</a>
          </div> 
        </div> -->
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="documentation" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">documentation</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../../../onecx-announcement/current/index.html">Announcement Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-announcement/current/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-bookmark/current/general/index.html">Bookmark Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-bookmark/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../contribution/current/contribution/index.html">Contribution</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../contribution/current/contribution/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-document-management/current/general/index.html">Document Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-document-management/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../../index.html">documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../general-information/current/general/index.html">General Information</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../general-information/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../guides/current/index.html">Guides</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../guides/current/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-help/current/general/index.html">Help Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-help/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-iam/current/general/index.html">IAM Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-iam/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../index/current/index.html">Index</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../index/current/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-portal-ui-libs/current/general/index.html">OneCX Portal UI Libs</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-portal-ui-libs/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-quarkus/current/onecx-quarkus/index.html">Onecx Quarkus</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-quarkus/current/onecx-quarkus/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-parameter/current/general/index.html">Parameter Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-parameter/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-permission/current/general/index.html">Permission Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-permission/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-product-store/current/general/index.html">Product Store Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-product-store/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-shell/current/general/index.html">Shell UI</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-shell/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-tenant/current/general/index.html">Tenant Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-tenant/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-test/current/general/index.html">Test Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-test/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-theme/current/general/index.html">Theme Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-theme/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-user-profile/current/general/index.html">User Profile Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-user-profile/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../utilities/current/general-info/index.html">Utilities</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../utilities/current/general-info/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-welcome/current/general/index.html">Welcome Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-welcome/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../onecx-workspace/current/general/index.html">Workspace Management</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../onecx-workspace/current/general/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../../index/current/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/onecx/onecx-local-env/edit/main/docs/modules/local-env/pages/general/versions/v2/migrate.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
      <h1 class="page">Versions - v2 - Migrate to v2</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Disclaimer</div>
<div class="paragraph">
<p>This page was created for an older version of OneCX Local Environment and may not reflect the current state of the project. It will be updated in the near future.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This guide highlights the key differences between OneCX Local Environment <a href="../v1/v1.html" class="xref page">v1</a> and <a href="v2.html" class="xref page">v2</a>, and explains how you can adapt your setup to ensure that it seamlessly works with <a href="v2.html" class="xref page">v2</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_network_rename"><a class="anchor" href="#_network_rename"></a>Network Rename</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In <a href="../v1/v1.html" class="xref page">v1</a>, the network that all services connected to was named <code>example</code>.
In <a href="v2.html" class="xref page">v2</a>, this network is now named <code>default</code>.</p>
</div>
<div class="paragraph">
<p>If you have any custom services that need to attach to the same network as OneCX, make sure they connect to <code>default</code> from now on.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_service_startup_behavior"><a class="anchor" href="#_service_startup_behavior"></a>Service Startup Behavior</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In <a href="../v1/v1.html" class="xref page">v1</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some core services started automatically when running: <code>docker compose up -d</code></p>
</li>
<li>
<p>Additional services could be started using the two existing profiles: <code>all</code> and <code>parameters</code>.</p>
</li>
<li>
<p>This approach gave developers very little control over which apps were started, making it hard to, for example, run only a small subset of apps and one OneCX product.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In <a href="v2.html" class="xref page">v2</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The system is <strong>fully profile-based</strong>.</p>
</li>
<li>
<p><strong>Nothing</strong> starts by default when you run: <code>docker compose up -d</code></p>
</li>
<li>
<p>You must explicitly specify at least one profile, for example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker compose --profile base up -d</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Profiles allow fine-grained control over which services run.</p>
</li>
<li>
<p>For details on available profiles, see <a href="v2.html" class="xref page">the v2 documentation</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_import_script_improvements"><a class="anchor" href="#_data_import_script_improvements"></a>Data Import Script Improvements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In <a href="../v1/v1.html" class="xref page">v1</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The data import script had the sole purpose of sending data to services to trigger the import.</p>
</li>
<li>
<p>This caused issues if containers were not running, unhealthy, or still starting up.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In <a href="v2.html" class="xref page">v2</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The import script now:</p>
<div class="ulist">
<ul>
<li>
<p>Starts all required services.</p>
</li>
<li>
<p>Waits for them to become healthy and operational.</p>
</li>
<li>
<p>Imports the data.</p>
</li>
<li>
<p>Spins down the started services afterward.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This improves reliability for most developers.
However, if you use the script inside another script that needs containers to remain running after import, you can disable container management by running the script using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">SKIP_CONTAINER_MANAGEMENT=true ./import-onecx.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>This ensures the script does not start or stop any containers, allowing you to manage them manually. <strong>Please be aware that in this mode, it&#8217;s your responsibility to ensure that all required containers (Traefik, Postgres, Keycloak and all OneCX SVCs) are running and healthy before executing the script.</strong></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_moved_env_files"><a class="anchor" href="#_moved_env_files"></a>Moved ENV Files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before the creation of <a href="v2.html" class="xref page">v2</a>, all environment variable files were located in the root directory of the project. To allow for better organization and scoped environment variables per version, all environment variable files are now located in the directory of the version they belong to (e.g., <code>./versions/v2/</code> for v2). As of right now, <code>./versions/v1/</code> and <code>./versions/v2/</code> contain identical <code>.env</code>, <code>bff.env</code> and <code>svc.env</code> files, but this may change in the future (e.g. if different image tags have to be used for different versions). If you or any of your scripts reference these files, please update the paths accordingly.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Checkpoint</div>
<div class="paragraph">
<p>After reading all sections of this document you should be able to make all necessary adjustments to migrate from v1 to v2 of the OneCX Local Environment.
To recap, the main necessary adjustments are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change any custom services that connect to the <code>example</code> network to connect to the <code>default</code> network instead.</p>
</li>
<li>
<p>Change any scripts or commands that start services to use profiles instead of relying on default behavior.</p>
</li>
<li>
<p>Adjust import scripts if you need to manage container states manually.</p>
</li>
<li>
<p>Update paths to any <code>.env</code>, <code>bff.env</code> or <code>svc.env</code> files to point to the new locations in the respective version directory.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
  </article>  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../../../_/js/site.js" data-ui-root-path="../../../../../../_"></script>
<script async src="../../../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../../../.." data-snippet-length="100" data-stylesheet="../../../../../../_/css/search.css"></script>
<script async src="../../../../../../search-index.js"></script>
<script>
    document.addEventListener('readystatechange', event => {
    if (event.target.readyState === "complete") {
        renderAllBpmnJs();
    }
    });    
</script>
  </body>
</html>
